// Studio primitives
import { DataStore } from "aws-amplify"
import * as React from "react";
import { Box, ChakraProvider, Image } from "@chakra-ui/react"

export * from "@chakra-ui/icons"
export * from "@chakra-ui/react"

export function Collection({ children = () => null, model, predicate }) {
  const [data, setData] = React.useState([])

  React.useEffect(() => {
    DataStore.query(model, predicate).then(setData)
  }, [])

  // ❗️ TODO Listen for CRUD via subscriptions  
  return <Box>{data.map(children)}</Box>
}

// ❗️ Studio should have it's own `Media` data type with a contract that we depend on here
export function Media({ media }) {
  return media.type === 'VIDEO' ? (
    <video controls autoPlay>
      <source src={media.source} type="video/mp4" />
    </video>
  ) : (
    <Image src={media.source} />
  )
}

export { ChakraProvider as StudioProvider }